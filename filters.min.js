filtersJs = {

    addPositiveKeyword: function(parent, h) {

        //addPositiveKeyword
        addKeyword(true, h);

        // add tags with true/false--positive/negative
        function addKeyword(isPositive, input) {

            transcription = document.getElementById("keywords_transcription")
            if (isPositive == true) {
                sClass = "label-info"
                    //alert(input);
            } else {
                sClass = "label-important"
            }

            div = document.getElementById("keywords")
            s = '<span class="label ' + sClass + '" valign="middle" value="' + input + '">' +
                "<a href='javascript:void(0)' onclick='$(this).parent().remove();updateKeywordsTranscriptions();' class='close' data-dismiss='alert'> <i class='icon-remove-sign'></i></a> " + input + " " +
                "</span> "

            if (input.trim().length == 0) {
                return;
            }

            div.innerHTML = div.innerHTML + s

            transcription.value = div.innerHTML
            input = ""
            $('#btnKeywordI').attr('disabled', true);
            $('#btnKeywordE').attr('disabled', true);
        }

        function updateKeywordsTranscriptions($this) {
            transcription = document.getElementById("keywords_transcription")
            div = document.getElementById("keywords")
            transcription.value = div.innerHTML
        }

        //input field empty check and enable/disable buttons
        $('#keyword').on('input', function() {
            var i = $.trim($(this).val()).length;
            if (i > 0) {
                $('#btnKeywordI').prop('disabled', false);
                $('#btnKeywordE').prop('disabled', false);
            } else {
                $('#btnKeywordI').prop('disabled', true);
                $('#btnKeywordE').prop('disabled', true);
            }
        });

    },

    addNegativeKeywords: function(parent, h) { 

        //addNegativeKeywords
        addKeyword(false, h);

        // add tags with true/false--positive/negative
        function addKeyword(isPositive, input) {

            transcription = document.getElementById("keywords_transcription")
            if (isPositive == true) {
                sClass = "label-info"
                    //alert(input);
            } else {
                sClass = "label-important"
            }

            div = document.getElementById("keywords")
            s = '<span class="label ' + sClass + '" valign="middle" value="' + input + '">' +
                "<a href='javascript:void(0)' onclick='$(this).parent().remove();updateKeywordsTranscriptions();' class='close' data-dismiss='alert'> <i class='icon-remove-sign'></i></a> " + input + " " +
                "</span> "

            if (input.trim().length == 0) {
                return;
            }

            div.innerHTML = div.innerHTML + s

            transcription.value = div.innerHTML
            input = ""
            $('#btnKeywordI').attr('disabled', true);
            $('#btnKeywordE').attr('disabled', true);
        }

        function updateKeywordsTranscriptions($this) {
            transcription = document.getElementById("keywords_transcription")
            div = document.getElementById("keywords")
            transcription.value = div.innerHTML
        }

        //input field empty check and enable/disable buttons
        $('#keyword').on('input', function() {
            var i = $.trim($(this).val()).length;
            if (i > 0) {
                $('#btnKeywordI').prop('disabled', false);
                $('#btnKeywordE').prop('disabled', false);
            } else {
                $('#btnKeywordI').prop('disabled', true);
                $('#btnKeywordE').prop('disabled', true);
            }
        });

    },

    getPositiveKeywords: function(parent) {

        var arr = [];
        $(".label-info").each(function(index, elem) {
            arr.push($(this).text());
        });

        return alert(arr);
    },

    getNegativeKeywords: function(parent) {

        var arr = [];
        $(".label-important").each(function(index, elem) {
            arr.push($(this).text());
        });

        return alert(arr);
    },

    removeKeyword: function(parent, h) {

        $('span').filter(function() {
            return $.trim($(this).text()) == h;
        }).remove();
    },

    draw: function(parent, h) {

        var s =
            "<div class='control-group span4'>" +
            "	<label class='control-label' for='inputKeywords'>Keywords</label>" +
            "	<div class='controls'>" +
            "		<div class='row-fluid'>" +
            "			<div class='span8'>" +
            "				<input onchange='' type='text' class='input-large' name='keyword' id='keyword' list='keywords_list' placeholder='Keywords' tabindex='2' >" +
            "				<input type='hidden' name='keywords_transcription' id='keywords_transcription' value=''>" +
            "				<p >Press ENTER to add the keyword. Or use the include/exclude buttons.</p>" +
            "				<datalist id='keywords_list'>" +

            "				</datalist>" +
            "			</div>" +
            "			<div class='span4'>" +
            "				<button id='btnKeywordI' class='include-button btn btn-mini btn-blue' type='button' disabled><i class='icon-plus' tabindex='-1'></i> Include</button>" +
            "				<button id='btnKeywordE' class='exclude-button btn btn-mini btn-red' type='button'  disabled><i class='icon-minus' tabindex='-1'></i> Exclude</button>" +
            "			</div>" +
            "		</div>" +

            "		<div id='keywords' name='keywords'></div>" +
            "	</div>" +
            "</div>";

        // // add html
        $(parent).html(s);


        if (h['allowed_positive_keywords'] != null) {
            if (h['allowed_positive_keywords'] == false) {
                $('#btnKeywordI').hide();
            }
        }

        if (h['allowed_negative_keywords'] != null) {
            if (h['allowed_negative_keywords'] == false) {
                $('#btnKeywordE').hide();
            }
        }


        if (h['allowed_values'] == null) {
            //console.log("please add allowed_values")
        } else {
            $.each(h['allowed_values'], function(index, value) {
                //alert(value);  
                $("#keywords_list").append('<option value="' + value + '">' + value + '</option>')
            });
        }

        var jsIndustries = [];

        $('#keyword').on('input', function() {

            if (h['allowed_values'] == null) {
                var i = $.trim($(this).val()).length;
                if (i > 0) {
                    $('#btnKeywordI').prop('disabled', false);
                    $('#btnKeywordE').prop('disabled', false);
                } else {
                    $('#btnKeywordI').prop('disabled', true);
                    $('#btnKeywordE').prop('disabled', true);
                }

            } else
                validateIndustry();
        });

        function validateIndustry() {
            value = $('#keyword').val().toLowerCase();

            $('#keywords_list').children().each(function(i, e) {
                jsIndustries.push({
                    id: $.trim($(e).val()),
                    value: $.trim($(e).text().toLowerCase())
                });
            });

            if (searchh(value, jsIndustries)) {

                $('#btnKeywordI').prop('disabled', false);
                $('#btnKeywordE').prop('disabled', false);
                return true;
            } else {
                $('#btnKeywordI').prop('disabled', true);
                $('#btnKeywordE').prop('disabled', true);
                return false;
            }

            jsIndustries = [];
        }

        function searchh(nameKey, myArray) {
            for (var i = 0; i < myArray.length; i++) {
                if (myArray[i].value === nameKey) {
                    return true;
                }
            }
        }

        // event: on click ENTER button
        $(parent).find('#keyword').keydown(function(e) {
            if (e.which == 13) { // ENTER
                addKeyword(true);
            }

        });

        // include button add tag
        $(parent).find('.include-button').click(function() {
            addKeyword(true);
        });


        // exclude button add tag
        $(parent).find('.exclude-button').click(function() {
            addKeyword(false);
        });

        // add tags with true/false--positive/negative
        function addKeyword(isPositive) {
            input = document.getElementById("keyword")
            transcription = document.getElementById("keywords_transcription")

            if (isPositive == true && h['allowed_positive_keywords'] == true) {
                sClass = "label-info"

                //alert(input.value);
                if (h['on_positive_keyword_added'] != null)
                    h['on_positive_keyword_added'](input.value + "");

            } else {
                sClass = "label-important"

                //alert(input.value);
                if (h['on_negative_keyword_added'] != null)
                    h['on_negative_keyword_added'](input.value + "");
                //alert(input.value);
            }

            div = document.getElementById("keywords")
            s = '<span class="label ' + sClass + '" valign="middle" value="' + input.value + '">' +
                "<a href='javascript:void(0)' onclick='$(this).parent().remove();updateKeywordsTranscriptions();' class='close' data-dismiss='alert'> <i class='icon-remove-sign'></i></a> " + input.value + " " +
                "</span> "

            if (input.value.trim().length == 0) {
                return;
            }

            div.innerHTML = div.innerHTML + s

            transcription.value = div.innerHTML
            input.value = ""
            $('#btnKeywordI').attr('disabled', true);
            $('#btnKeywordE').attr('disabled', true);
        }

        function updateKeywordsTranscriptions($this) {
            transcription = document.getElementById("keywords_transcription")
            div = document.getElementById("keywords")
            transcription.value = div.innerHTML
        }
    },

};